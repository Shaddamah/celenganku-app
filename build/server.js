(()=>{var e={896:(e,t,r)=>{var n=r(622),s=r(766),o=r(342),a=r(876);e.exports={entry:{main:"./src/scripts/index.js"},output:{path:n.join(__dirname,"build"),publicPath:"/",filename:"[name].js"},target:"web",devtool:"source-map",module:{rules:[{test:/\.html$/,use:[{loader:"html-loader"}]},{test:/\.(sa|sc|c)ss$/,use:["style-loader",{loader:"css-loader",options:{importLoaders:1}},"postcss-loader"]},{test:/\.(png|svg|jpg|gif)$/,use:["file-loader"]}]},plugins:[new s({name:"Client"}),new a({patterns:[{from:"./src/public/",to:"./"}]}),new o({template:"./src/index.html",filename:"./index.html",excludeChunks:["server"]})]}},86:(e,t,r)=>{var n=r(535).merge,s=r(78),o=r(896);e.exports=n(o,{mode:"development",plugins:[new s.HotModuleReplacementPlugin,new s.NoEmitOnErrorsPlugin],stats:"errors-only"})},876:e=>{"use strict";e.exports=require("copy-webpack-plugin")},342:e=>{"use strict";e.exports=require("html-webpack-plugin")},622:e=>{"use strict";e.exports=require("path")},78:e=>{"use strict";e.exports=require("webpack")},535:e=>{"use strict";e.exports=require("webpack-merge")},766:e=>{"use strict";e.exports=require("webpackbar")}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(78),t=r.n(e);const n=require("webpack-dev-middleware");var s=r.n(n);const o=require("webpack-hot-middleware");var a=r.n(o);require("regenerator-runtime");const u=require("express");var i=r.n(u),c=r(622),p=r.n(c);const l=require("body-parser");var f=r.n(l);const d=require("cors");var m=r.n(d);const v=require("helmet");var g=r.n(v);const w=require("hpp");var h=r.n(w);const y=require("xss-clean");var b=r.n(y);const x=require("cookie-parser");var k=r.n(x);const S={PORT:process.env.PORT||8080,DIST_DIR:__dirname};var _=r(86),j=r.n(_);function R(e){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){var t="function"==typeof Map?new Map:void 0;return function(e){if(null===e||(e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return E(e,arguments,I(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),O(n,e)}(e)}function E(e,t,r){return(q()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var s=new(Function.bind.apply(e,n));return r&&O(s,r.prototype),s}).apply(null,arguments)}function q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function O(e,t){return(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){return(Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Error;function T(e,t,r,n,s,o,a){try{var u=e[o](a),i=u.value}catch(e){return void r(e)}u.done?t(i):Promise.resolve(i).then(n,s)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){T(o,n,s,a,u,"next",e)}function u(e){T(o,n,s,a,u,"throw",e)}a(void 0)}))}}const C=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){var e=N(regeneratorRuntime.mark((function e(r,n,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t.forEach(function(){var e=N(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.doc(r.params.id).delete();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.status(200).json({status:"success",error:!1,results:"Deleted ".concat(t.length," document")})}catch(e){n.status(502).json({status:"success",error:!0,response:e})}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},D=function(e){return function(){var t=N(regeneratorRuntime.mark((function t(r,n,s){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.doc(r.params.id).get();case 3:if((o=t.sent).exists){t.next=7;break}return n.status(401).json({status:"failed",error:!0,message:"No document found with that id",response:r.params}),t.abrupt("return",{success:!1});case 7:return a=o.data(),n.status(200).json({status:"success",error:!1,data:a}),t.abrupt("return",{success:!0});case 12:t.prev=12,t.t0=t.catch(0),n.status(502).json({status:"success",error:!0,response:t.t0});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r,n){return t.apply(this,arguments)}}()},F=function(e){return function(){var t=N(regeneratorRuntime.mark((function t(r,n,s){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=[],t.next=4,e.get();case 4:if(t.sent.forEach((function(e){o.push(e.data())})),n.status(200).json({status:"success",error:!1,results:o.length,data:o}),!(o.length>0)){t.next=9;break}return t.abrupt("return",{success:!0});case 9:return t.abrupt("return",{success:!1});case 12:t.prev=12,t.t0=t.catch(0),n.status(502).json({status:"success",error:!0,response:t.t0});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r,n){return t.apply(this,arguments)}}()},M=require("firebase/app");var K=r.n(M);require("firebase/firestore");const X=K().initializeApp({apiKey:"AIzaSyAW4XYKvHlGB2n85IrI311kXrFp-S_11YM",authDomain:"celenganku-app.firebaseapp.com",databaseURL:"https://celenganku-app.firebaseio.com",projectId:"celenganku-app",storageBucket:"celenganku-app.appspot.com",messagingSenderId:"414105942761",appId:"1:414105942761:web:f68bc17372af32cf848e78",measurementId:"G-QQ3YEP9ZCT"}).firestore(),Y={data:X.collection("data_siswa"),akun:X.collection("akun_siswa"),profil:X.collection("profil_siswa")};function $(e,t,r,n,s,o,a){try{var u=e[o](a),i=u.value}catch(e){return void r(e)}u.done?t(i):Promise.resolve(i).then(n,s)}function z(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){$(o,n,s,a,u,"next",e)}function u(e){$(o,n,s,a,u,"throw",e)}a(void 0)}))}}var B,G;const H={getAllSiswaData:F(Y.data),getAllAkunSiswa:F(Y.akun),getDataSiswa:D(Y.data),getProfilSiswa:D(Y.profil),getAkunSiswa:D(Y.akun),deleteAkunSiswa:C(Y.akun,Y.profil),createAkunSiswa:(G=z(regeneratorRuntime.mark((function e(t,r,n){var s,o,a,u,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=t.body,o=s.nisn,a=s.email,u=s.password,i=s.no_telepon,c=s.url_foto,o&&a&&u){e.next=4;break}return e.abrupt("return",r.status(404).json({status:"failed",error:!0,message:"Please provide NISN, Email, or password",response:t.body}));case 4:return e.next=6,Y.data.doc(o).get();case 6:return e.sent.exists||r.status(401).json({status:"failed",error:!0,message:"This NISN isn't registered",response:t.body}),e.next=10,Y.akun.doc(o).get();case 10:return e.sent.exists&&r.status(401).json({status:"failed",error:!0,message:"Account with this NISN already exist",response:t.body}),e.next=14,Y.akun.doc(o).set({nisn:o,email:a,password:u,saldo:0});case 14:return e.next=16,Y.profil.doc(o).set({nisn:o,no_telepon:i||"",url_foto:c||""});case 16:return r.status(200).json({status:"success",error:!1,response:t.body}),e.abrupt("return",{error:!1});case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0),r.status(502).json({status:"success",error:!0,response:e.t0});case 24:case"end":return e.stop()}}),e,null,[[0,20]])}))),function(e,t,r){return G.apply(this,arguments)}),updateAkunSiswa:(B=z(regeneratorRuntime.mark((function e(t,r,n){var s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=t.params.id,e.next=4,Y.akun.doc(s).get();case 4:if((o=e.sent).exists||r.status(401).json({status:"failed",error:!0,message:"Account with this NISN doesn't exist",response:t.body}),a=o.data(),(u={email:t.body.email||a.email,password:t.body.password||a.password,no_telepon:t.body.no_telepon||a.no_telepon,url_foto:t.body.url_foto||a.url_foto}).email&&u.password){e.next=10;break}return e.abrupt("return",r.status(404).json({status:"failed",error:!0,message:"Please provide Email, or password",response:t.body}));case 10:return e.next=12,Y.akun.doc(s).update({email:u.email,password:u.password});case 12:return e.next=14,Y.profil.doc(s).set({no_telepon:u.no_telepon||"",url_foto:u.url_foto||""});case 14:return r.status(200).json({status:"success",error:!1,response:t.body}),e.abrupt("return",{success:!0});case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0),r.status(502).json({status:"failed",error:!0,response:e.t0});case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),function(e,t,r){return B.apply(this,arguments)})},L=require("dotenv");var Q=r.n(L);const W=require("jsonwebtoken");var U,Z,J=r.n(W);function V(e,t,r,n,s,o,a){try{var u=e[o](a),i=u.value}catch(e){return void r(e)}u.done?t(i):Promise.resolve(i).then(n,s)}function ee(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){V(o,n,s,a,u,"next",e)}function u(e){V(o,n,s,a,u,"throw",e)}a(void 0)}))}}Q().config();const te={authenticateToken:function(e,t,r){try{console.log(e.cookies);var n=e.cookies.jwt;if(null==n)return t.sendStatus(401);J().verify(n,process.env.ACCESS_TOKEN_SECRET,(function(n,s){if(console.log(n),n)return t.sendStatus(403);e.user=s,r()}))}catch(e){r(e)}},login:(Z=ee(regeneratorRuntime.mark((function e(t,r,n){var s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=t.body,o=s.nisn,a=s.password,o&&a){e.next=4;break}return e.abrupt("return",r.status(404).json({status:"failed",error:!0,message:"Please provide NISN, or password",response:t.body}));case 4:return e.next=6,Y.akun.where("nisn","==",o).where("password","==",a).get();case 6:e.sent.empty&&r.status(401).json({status:"failed",error:!0,message:"Wrong NISN or Password",response:t.body}),c=void 0,c="user",(i=o).length<10&&(c="admin"),u=J().sign({id:i,role:c},process.env.ACCESS_TOKEN_SECRET,{expiresIn:process.env.ACCESS_EXPIRE_TIME}),t.body.password=void 0,r.cookie("jwt",u,{httpOnly:!0,maxAge:2592e5}),r.status(200).json({status:"success",error:!1,response:t.body}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),n(e.t0);case 17:case"end":return e.stop()}var i,c}),e,null,[[0,14]])}))),function(e,t,r){return Z.apply(this,arguments)}),register:(U=ee(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.createAkunSiswa(t,r,n);case 2:case"end":return e.stop()}}),e)}))),function(e,t,r){return U.apply(this,arguments)})};var re=i().Router();re.use(f().json()),re.post("/login",te.login),re.post("/register",te.register),re.use(te.authenticateToken),re.route("/").get(H.getAllAkunSiswa),re.route("/:id").get(H.getAkunSiswa).patch(H.updateAkunSiswa).delete(H.deleteAkunSiswa),re.route("/:id/profil").get(H.getProfilSiswa),re.route("/:id/data").get(H.getDataSiswa);const ne=re;var se=i()(),oe=p().join(__dirname,"index.html"),ae=t()(j());se.use(s()(ae,{publicPath:j().output.publicPath})),se.use(a()(ae)),se.use(m()()),se.use(g()()),se.use(b()()),se.use(h()()),se.use(k()()),se.use(i().json({limit:"15kb"})),se.use("/api/siswa",ne),se.use("/user",te.authenticateToken),se.use(f().json()),se.use(i().static(__dirname)),se.use("/",(function(e,t){t.sendFile(oe)})),se.get("*",(function(e,t,r){ae.outputFileSystem.readFile(p().join(S.DIST_DIR,"index.html"),(function(e,n){if(e)return r(e);t.set("content-type","text/html"),t.send(n),t.end()}))})),se.listen(S.PORT,(function(){console.log("App listening to ".concat(S.PORT,"....")),console.log("Press Ctrl+C to quit.")}))})()})();